$schema: "http://json-schema.org/draft-07/hyper-schema#"
type: object
descreption: >- 
  An interaction machine object encapsulates the complete set of objects that define an interaction ->
  Triggers, Outcomes, Schema, and metadata.
properties:
  name:
    description: A human readable label for the intraction to be used in interfaces.
    type: string
    example:
      - sigh-up
      - order-checkout
  class:
    description: Describes the nature of an intreaction content based on the current representation.
    type: array
    items:
      type: string
      example:
        - screen-set
        - checkout-api
        - subscribtion-collection-form
        - lite-sign-up

    
  input:
    description: A set of key-value pairs that describe the input of an intraction.
    type: object
    properties:
      identity:
        type: object
        $ref: .\IdentityTemplate.yaml

      profile:
        title: profile fields
        description: Profile fields to collect during interaction.
        type: object
        allOf:
          - $ref: ..\..\..\shared\schemas\CustomTemplate.yaml
            
      data:
        title: profile fields
        description: Custom data fields to collect during interaction.
        type: object
        allOf:
          - $ref: ..\..\..\shared\schemas\CustomTemplate.yaml

      subscriptions:
        title: subscriptions fields
        description: Subscribtions fields to collect during interaction.
        type: object
        allOf:
          - $ref: ..\..\..\shared\schemas\BooleanTemplate.yaml    
            
      consents:
        title: consents fields
        description: Consents fields to collect during interaction.
        type: object
        allOf:
          - $ref: ..\..\..\shared\schemas\BooleanTemplate.yaml

      interaction:
        title: interaction fields
        description: Interaction scoped fields.
        type: object
        allOf:
          - $ref: ..\..\..\shared\schemas\CustomTemplate.yaml


  outcomes:
    type: object
    description: A set of key-value pairs that describe the possible outcomes of the intraction.
    properties:

      require_auth:
        type: object
        properties:
          output:
            type: object
            properties:
              type:
                type: string
                readOnly: true
                default: auth
              identity:
                type: string
                readOnly: true 
                default:  "#/properties/identity"


      authorized:
        type: object
        properties:
          output:
            type: object
            readOnly: true
            properties:
              type:
                type: string
                readOnly: true
                default: projection
              identity:
                type: string
                readOnly: true
                default: "#/properties/identity"   
              profile:
                type: string
                readOnly: true
                default: "#/properties/profile"
              subscriptions:
                type: string
                readOnly: true
                default: "#/properties/subscriptions"
              consents:
                type: string
                readOnly: true
                default: "#/properties/consents"  